<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="SIRthresholded">
<title>How to use the SIRthresholded package • SIRthresholded</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="How to use the SIRthresholded package">
<meta property="og:description" content="SIRthresholded">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">SIRthresholded</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="../articles/SIRthresholded.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>How to use the SIRthresholded package</h1>
                        <h4 data-toc-skip class="author">Clément
Weinreich</h4>
            
            <h4 data-toc-skip class="date">2023-06-09</h4>
      
      
      <div class="d-none name"><code>SIRthresholded.Rmd</code></div>
    </div>

    
    
<p><strong>Table of content</strong></p>
<ul>
<li><a href="#how-sir-and-sir-thresholded-works">How SIR and SIR
thresholded works</a></li>
<li><a href="#overview-of-the-package">Overview of the package</a></li>
<li><a href="#example-with-simulated-data">Example with simulated
data</a></li>
<li><a href="#example-with-wine-dataset">Example with wine
dataset</a></li>
</ul>
<hr>
<p>This package offers an implementation of the <span class="math inline">\(SIR\)</span> (Sliced Inverse Regression) method,
along with a thresholded version of <span class="math inline">\(SIR\)</span> that allows variable selection. The
purpose of this vignettes is to explain the function implemented in the
package, and how they are used. The first section is dedicated to the
theoretical explaination of <span class="math inline">\(SIR\)</span>,
and its thresholded version. Reading this section is therefore optional,
but can be useful to better understand how the package functions
work.</p>
<div class="section level2">
<h2 id="how-sir-and-sir-thresholded-works">How SIR and SIR thresholded works<a class="anchor" aria-label="anchor" href="#how-sir-and-sir-thresholded-works"></a>
</h2>
<div class="section level3">
<h3 id="the-semi-parametric-model">The semi-parametric model<a class="anchor" aria-label="anchor" href="#the-semi-parametric-model"></a>
</h3>
<p>Consider the following semi-parametric model: <span class="math display">\[Y = g(\beta'X,\epsilon)\]</span> where:</p>
<ul>
<li>
<span class="math inline">\(Y \in \mathbb{R}\)</span> is a
univariate response variable</li>
<li>
<span class="math inline">\(X \in \mathbb{R}^p\)</span> is a <span class="math inline">\(p\)</span>-dimensional covariates such as <span class="math inline">\(\mathbb{E}(X)=\mu\)</span> and <span class="math inline">\(\mathbb{V}(X)=\Sigma\)</span>
</li>
<li>
<span class="math inline">\(\beta\)</span> is a vector generating a
direction of <span class="math inline">\(\mathbb{R}^p\)</span>
</li>
<li>
<span class="math inline">\(\epsilon\)</span> is the random error
term, assumed independant of <span class="math inline">\(X\)</span>
</li>
<li>
<span class="math inline">\(g\)</span> is an arbitrary link function
(unknown)</li>
</ul>
<p>It is common to present the model as <span class="math inline">\(Y\perp X\mid \beta'X\)</span> which means that
<span class="math inline">\(Y\)</span> is independent of <span class="math inline">\(X\)</span> conditional on <span class="math inline">\(\beta'X\)</span>. Thus, it is possible to
replace <span class="math inline">\(X\in\mathbb{R}^p\)</span> with the
index <span class="math inline">\(\beta'X\in\mathbb{R}\)</span>
without loss of information in the regression of <span class="math inline">\(Y\)</span> on <span class="math inline">\(X\)</span>. Thus, we do dimension reduction of the
explanatory part <span class="math inline">\(X\)</span> from <span class="math inline">\(p\)</span>-dimension to <span class="math inline">\(1\)</span>-dimension, without specifying either
the relationship between the index <span class="math inline">\(\beta'X\)</span> and <span class="math inline">\(Y\)</span> or the distribution of the error term
<span class="math inline">\(\epsilon\)</span>.</p>
<p>In the framework of this model, <span class="math inline">\(g\)</span> being unknown, we cannot identify <span class="math inline">\(\beta\)</span>, but we can identify its direction.
We then define the <span class="math inline">\(EDR\)</span> (Effective
Dimension Reduction) space <span class="math inline">\(E\)</span> as the
linear subspace of <span class="math inline">\(\mathbb{R}^p\)</span>
generated by <span class="math inline">\(\beta\)</span>. Any vector
belonging to <span class="math inline">\(E\)</span> is then an <span class="math inline">\(EDR\)</span> direction.</p>
</div>
<div class="section level3">
<h3 id="the-sir-method">The SIR method<a class="anchor" aria-label="anchor" href="#the-sir-method"></a>
</h3>
<p>The <span class="math inline">\(SIR\)</span> method is used to obtain
the estimate of an <span class="math inline">\(EDR\)</span> direction.
In theory, the <span class="math inline">\(SIR\)</span> method requires
a condition on the distribution of the explanatory variable <span class="math inline">\(X\)</span> called the linearity condition: <span class="math inline">\(\forall b \in\mathbb{R}^p,
\mathbb{E}[b'X\mid\beta'X]\)</span> is linear in <span class="math inline">\(X'\beta\)</span>. In practice, it is
impossible to verify this assumption because <span class="math inline">\(\beta\)</span> is unknown and unidentifiable.
However, this assumption is valid when the distribution of <span class="math inline">\(X\)</span> is elliptical, which is the case for
the multidimensional normal distribution.</p>
<p>Let’s now consider a monotonic transformation <span class="math inline">\(T\)</span> (which in the case of the SIR method
will correspond to a slicing function). Under the previous model and the
linearity condition, (Duan &amp; Li, 1991) showed that the centered
inverse regression curve verifies : <span class="math display">\[\mathbb{E}[X\mid T(Y)] - \mu \in
\mbox{Span}(\Sigma\beta)\]</span> Thus, the subspace generated by this
curve, <span class="math inline">\({\mathbb{E}[X \mid T(Y)] -
\mathbb{E}[X] : Y \in \mathcal{Y}}\)</span> (where <span class="math inline">\(\mathcal{Y}\)</span> is the support for the
response variable <span class="math inline">\(Y\)</span>), belongs to
the <span class="math inline">\(EDR\)</span> space. Therefore, the
centered inverse regression curve can clearly be used to find the <span class="math inline">\(EDR\)</span> space.</p>
<p>A direct consequence of this result, is that the variance covariance
matrix of this curve, <span class="math inline">\(\Gamma =
\mathbb{V}(\mathbb{E}[X \mid T(Y)])\)</span>, is degenerate in any
direction <span class="math inline">\(\Sigma\)</span>-orthogonal to
<span class="math inline">\(\beta\)</span>. Therefore, the eigenvector
associated with the largest nonzero eigenvalue of the matrix of interest
<span class="math inline">\(\Sigma^{-1}\Gamma\)</span> is an <span class="math inline">\(EDR\)</span> direction, so it generates the <span class="math inline">\(EDR\)</span> space <span class="math inline">\(E\)</span>.</p>
<p>In the slicing step of the <span class="math inline">\(SIR\)</span>
method, the support of <span class="math inline">\(Y\)</span> is sliced
into <span class="math inline">\(H\)</span> slices <span class="math inline">\(\{s_1,\dots,s_H\}\)</span>. With a function <span class="math inline">\(T\)</span> corresponding to this slicing, the
matrix <span class="math inline">\(\Gamma\)</span> can then be written
as <span class="math display">\[\Gamma=\sum_{h=1}^Hp_h(m_h-\mu)(m_h-\mu)'\]</span>
where <span class="math inline">\(p_h=P(Y\in s_h)\)</span> is the
theoretical proportion of <span class="math inline">\(Y_i\)</span>
falling in the <span class="math inline">\(s_h\)</span> slice and <span class="math inline">\(m_h=\mathbb{E}[X\mid Y\in s_h]\)</span> is the
theoretical mean of <span class="math inline">\(X_i\)</span> associated
with <span class="math inline">\(Y_i\)</span> falling in the <span class="math inline">\(s_h\)</span> slice. This matrix <span class="math inline">\(\Gamma\)</span> is therefore easy to estimate.</p>
<p><br></p>
<p>Let us consider a sample <span class="math inline">\(\{(X_i,Y_i),
i=1,\dots,n\}\)</span> generated from the previous model. In practice,
it is necessary to replace the theoretical moments <span class="math inline">\(\mu, \Sigma, p_h\)</span> and <span class="math inline">\(m_h\)</span> by the empirical moments. Then, an
estimator of a basis of the <span class="math inline">\(EDR\)</span>
space <span class="math inline">\(E\)</span> is obtained via the
eigenvector <span class="math inline">\(\hat{b}\)</span> associated to
the largest eigenvalue of the estimator <span class="math inline">\(\widehat{\Sigma}_n^{-1}\widehat{\Gamma}_n\)</span>
of <span class="math inline">\(\Sigma^{-1}\Gamma\)</span> where :</p>
<ul>
<li><p><span class="math inline">\(\widehat{\Sigma}_n= \frac{1}{n}
\sum_{i=1}^n (X_i - \bar{X}_n)(X_i -\bar{X}_n)'\)</span> is the
empirical variance covariance matrix of <span class="math inline">\(X\)</span></p></li>
<li><p><span class="math inline">\(\widehat{\Gamma}_n= \sum_{h=1}^H\hat
p_{h,n} (\hat m_{h,n} - \bar{X}_n)(\hat m_{h,n}
-\bar{X}_n)'\)</span> is the empirical variance covariance matrix of
the empirical means of <span class="math inline">\(X\)</span> per slices
<span class="math inline">\(s_h\)</span></p></li>
</ul>
<p>with :</p>
<ul>
<li><p><span class="math inline">\(\bar{X}_n=
\frac{1}{n}\sum_{i=1}^nX_i,\)</span> the empirical mean of the
sample</p></li>
<li><p><span class="math inline">\(\hat p_{h,n} =
\frac{1}{n}\sum_{i=1}^{n} \mathbb{I} {[Y_i\in {s_h} ]} =
\frac{\hat{n}_{h,n}}{n}\)</span> the empirical proportion of <span class="math inline">\(Y_i\)</span> falling in the slice <span class="math inline">\(s_h\)</span> (where <span class="math inline">\(n_{h,n}\)</span> is the number of <span class="math inline">\(Y\)</span> falling in the slice <span class="math inline">\(s_h\)</span>)</p></li>
<li><p><span class="math inline">\(\hat m_{h,n}=\frac{1}{\hat{n}_{h,n}
}\sum_{i\in {s_h}}X_i\)</span> the empirical mean of <span class="math inline">\(X_i\)</span> such that <span class="math inline">\(Y_i\)</span> falls into the slice <span class="math inline">\(h\)</span></p></li>
</ul>
</div>
<div class="section level3">
<h3 id="variable-selection-by-soft-or-hard-thresholding">Variable selection by soft or hard thresholding<a class="anchor" aria-label="anchor" href="#variable-selection-by-soft-or-hard-thresholding"></a>
</h3>
<p>It is possible to perform variable selection in SIR regression. The
method presented here is a computational method using soft or hard
thresholding of the matrix of interest. Let us define the soft
thresholding (<span class="math inline">\(S\)</span> as in soft) and
hard thresholding (<span class="math inline">\(H\)</span> as in hard)
operators that apply to any matrix <span class="math inline">\(M\)</span> of dimension <span class="math inline">\(p\times p\)</span>. For any real <span class="math inline">\(\lambda\geq 0\)</span> and <span class="math inline">\((i,j)\in \{1,\dots,p\}\times
\{1,\dots,p\}\)</span> :</p>
<p><span class="math display">\[
S_\lambda(M)_{i,j}= sign(M_{i,j}) \times \begin{cases}
      \lvert M_{i,j} \rvert -\lambda &amp; \mbox{if } \lvert M_{i,j}
\rvert -\lambda &gt;0, \\
      0 &amp; \text{otherwise.}
    \end{cases}
\]</span></p>
<p><span class="math display">\[
H_\lambda(M)_{i,j}= \begin{cases}
       M_{i,j}  &amp; \mbox{if } \lvert M_{i,j} \rvert -\lambda &gt;0,
\\
      0 &amp; \text{otherwise.}
    \end{cases}
\]</span></p>
<p>with <span class="math inline">\(sign\)</span> the function that
returns the sign of the considered element (<span class="math inline">\(1\)</span> if positive, <span class="math inline">\(0\)</span> if null and <span class="math inline">\(-1\)</span> if negative).</p>
<p>We then introduce two new methods:</p>
<ul>
<li>
<span class="math inline">\(ST-SIR\)</span> for soft thresholding of
the matrix of interest of the SIR approach, which considers the matrix
<span class="math inline">\(S_\lambda(\widehat{\Sigma}_n^{-1}\widehat{\Gamma}_n)\)</span>,</li>
<li>
<span class="math inline">\(HT-SIR\)</span> for hard thresholding of
the matrix of interest of the SIR approach, which considers the matrix
<span class="math inline">\(H_\lambda(\widehat{\Sigma}_n^{-1}\widehat{\Gamma}_n)\)</span>.</li>
</ul>
<p>For each approach, an eigenvector associated to the largest
eigenvalue of <span class="math inline">\(S_\lambda(\widehat{\Sigma}_n^{-1}\widehat{\Gamma}_n)\)</span>
or <span class="math inline">\(H_\lambda(\widehat{\Sigma}_n^{-1}\widehat{\Gamma}_n)\)</span>
is computed, for a given value of <span class="math inline">\(\lambda\)</span>.</p>
<p>The choice of the thresholding hyper-parameter <span class="math inline">\(\lambda\)</span> must provide a balance
between</p>
<ul>
<li>correct variable selection (by tilting some of the components of the
considered eigenvector to <span class="math inline">\(0\)</span>)</li>
<li>low distortion of the estimated direction <span class="math inline">\(\hat{b}\)</span>
</li>
</ul>
<p>Then, once the <span class="math inline">\(p^{\star}\)</span> useful
variables have been identified, a new <span class="math inline">\(SIR\)</span> model can be estimated on the basis
of these <span class="math inline">\(p^{\star}\)</span> selected
variables. Thus, the estimation of <span class="math inline">\(\beta\)</span> will be easier because the
estimation is done in a space of reduced dimension.</p>
</div>
</div>
<div class="section level2">
<h2 id="overview-of-the-package">Overview of the package<a class="anchor" aria-label="anchor" href="#overview-of-the-package"></a>
</h2>
<div class="section level3">
<h3 id="sir-function">
<code>SIR</code> function<a class="anchor" aria-label="anchor" href="#sir-function"></a>
</h3>
<p>Apply a single-index <span class="math inline">\(SIR\)</span> on
<span class="math inline">\((X,Y)\)</span> with <span class="math inline">\(H\)</span> slices. This function allows to obtain
an estimate of a basis of the <span class="math inline">\(EDR\)</span>
(Effective Dimension Reduction) space via the eigenvector <span class="math inline">\(\hat{b}\)</span> associated with the largest
nonzero eigenvalue of the matrix of interest <span class="math inline">\(\widehat{\Sigma}_n^{-1}\widehat{\Gamma}_n\)</span>.
Thus, <span class="math inline">\(\hat{b}\)</span> is an <span class="math inline">\(EDR\)</span> direction.</p>
</div>
<div class="section level3">
<h3 id="sir_bootstrap-function">
<code>SIR_bootstrap</code> function<a class="anchor" aria-label="anchor" href="#sir_bootstrap-function"></a>
</h3>
<p>Apply a single-index <span class="math inline">\(SIR\)</span> on
<span class="math inline">\(B\)</span> bootstraped samples of <span class="math inline">\((X,Y)\)</span> with <span class="math inline">\(H\)</span> slices.</p>
</div>
<div class="section level3">
<h3 id="sir_threshold-function">
<code>SIR_threshold</code> function<a class="anchor" aria-label="anchor" href="#sir_threshold-function"></a>
</h3>
<p>Apply a single-index <span class="math inline">\(SIR\)</span> on
<span class="math inline">\((X,Y)\)</span> with <span class="math inline">\(H\)</span> slices, with a parameter <span class="math inline">\(\lambda\)</span> which apply a soft/hard
thresholding to the interest matrix <span class="math inline">\(\widehat{\Sigma}_n^{-1}\widehat{\Gamma}_n\)</span>.</p>
</div>
<div class="section level3">
<h3 id="sir_threshold_opt-function">
<code>SIR_threshold_opt</code> function<a class="anchor" aria-label="anchor" href="#sir_threshold_opt-function"></a>
</h3>
<p>Apply a single-index SIR on <span class="math inline">\((X,Y)\)</span> with <span class="math inline">\(H\)</span> slices, with a soft/hard thresholding
of the interest matrix <span class="math inline">\(\widehat{\Sigma}_n^{-1}\widehat{\Gamma}_n\)</span>
by an optimal parameter <span class="math inline">\(\lambda_{opt}\)</span>. The <span class="math inline">\(\lambda_{opt}\)</span> is found automatically
among a vector of <code>n_lambda</code> <span class="math inline">\(\lambda\)</span>, starting from 0 to the maximum
value of <span class="math inline">\(\widehat{\Sigma}_n^{-1}\widehat{\Gamma}_n\)</span>.
For each feature of <span class="math inline">\(X\)</span>, the number
of <span class="math inline">\(\lambda\)</span> associated with a
selection of this feature is stored (in a vector of size <span class="math inline">\(p\)</span>). This vector is sorted in a decreasing
way. Then, thanks to <code><a href="https://rdrr.io/pkg/strucchange/man/breakpoints.html" class="external-link">strucchange::breakpoints</a></code>, a breakpoint
is found in this sorted vector. The coefficients of the variables at the
left of the breakpoint, tend to be automatically toggled to 0 due to the
thresholding operation based on <span class="math inline">\(\lambda_{opt}\)</span>, and so should be removed
(useless variables). Finally, <span class="math inline">\(\lambda_{opt}\)</span> corresponds to the first
<span class="math inline">\(\lambda\)</span> such that the associated
<span class="math inline">\(\hat{b}\)</span> provides the same number of
zeros as the breakpoint’s value.</p>
<p>For example, for <span class="math inline">\(X \in
\mathbb{R}^{10}\)</span> and <code>n_lambda=100</code>, this sorted
vector can look like this :</p>
<table class="table">
<thead><tr class="header">
<th>X10</th>
<th>X3</th>
<th>X8</th>
<th>X5</th>
<th>X7</th>
<th>X9</th>
<th>X4</th>
<th>X6</th>
<th>X2</th>
<th>X1</th>
</tr></thead>
<tbody><tr class="odd">
<td>2</td>
<td>3</td>
<td>3</td>
<td>4</td>
<td>4</td>
<td>4</td>
<td>6</td>
<td>10</td>
<td>95</td>
<td>100</td>
</tr></tbody>
</table>
<p>Here, the breakpoint would be 8.</p>
</div>
<div class="section level3">
<h3 id="sir_threshold_bootstrap-function">
<code>SIR_threshold_bootstrap</code> function<a class="anchor" aria-label="anchor" href="#sir_threshold_bootstrap-function"></a>
</h3>
<p>Apply a single-index optimally soft/hard thresholded <span class="math inline">\(SIR\)</span> with <span class="math inline">\(H\)</span> slices on <code>n_replications</code>
bootstraped replications of <span class="math inline">\((X,Y)\)</span>.
The optimal number of selected variables is the number of selected
variables that came back most often among the replications performed.
From this, we can get the corresponding <span class="math inline">\(\hat{b}\)</span> and <span class="math inline">\(\lambda_{opt}\)</span> that produce the same
number of selected variables in the result of
<code>SIR_threshold_opt</code>.</p>
<p>This method allow to validate the robustness of the model.</p>
</div>
</div>
<div class="section level2">
<h2 id="example-with-simulated-data">Example with simulated data<a class="anchor" aria-label="anchor" href="#example-with-simulated-data"></a>
</h2>
<p>In this section :</p>
<ul>
<li>
<a href="#generate-the-data">(1)</a> A dataset is created.</li>
<li>
<a href="#create-a-sir-model">(2)</a> Classic SIR is applied to this
dataset. The outputs from the S3 summary and plot methods are
described.</li>
<li>
<a href="#use-optimally-thresholded-sir">(3)</a> SIR optimally
thresholded is applied to this dataset in order to do variable
selection. The outputs from the S3 summary and plot methods are
described.</li>
<li>
<a href="#estimate-a-new-sir-model-on-the-relevant-variables">(4)</a> A new
SIR model is estimated on the relevant variables, selected by SIR
thresholded. We notice that the estimation of the EDR direction is
better than with the classic SIR method.</li>
<li>
<a href="#sir-thresholded-with-a-given-lambda-parameter">(5)</a> SIR
thresholded is applied on the dataset with a custom <span class="math inline">\(\lambda\)</span> parameter.</li>
<li>
<a href="#test-the-robustness-of-the-model-with-bootstrapping">(6)</a> A
bootstrapped version of SIR optimally thresholded is applied to the
data, in order to ensure the robustness of the model. The outputs from
the S3 summary and plot methods are described.</li>
</ul>
<div class="section level3">
<h3 id="generate-the-data">Generate the data<a class="anchor" aria-label="anchor" href="#generate-the-data"></a>
</h3>
<p>Let’s create <span class="math inline">\(Y = (X\beta)^3 +
\epsilon\)</span> with:</p>
<ul>
<li>
<span class="math inline">\(n=200\)</span> (Sample size)</li>
<li>
<span class="math inline">\(X\in \mathbb{R}^p\)</span> and <span class="math inline">\(X\sim\mathcal{N}(0,\mathbb{I}_p)\)</span>
</li>
<li>
<span class="math inline">\(p=30\)</span> and <span class="math inline">\(p^\star=10\)</span> (<span class="math inline">\(10\)</span> relevant variables in <span class="math inline">\(X\)</span>)</li>
<li>
<span class="math inline">\(\epsilon\sim\mathcal{N}(0,20)\)</span>
and <span class="math inline">\(\epsilon \perp \!\!\! \perp
X\)</span>.</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">200</span> <span class="co"># Sample size</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">30</span> <span class="co"># Number of variables in X</span></span>
<span><span class="va">p_star</span> <span class="op">&lt;-</span> <span class="fl">10</span> <span class="co"># Number of relevant variables in X</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="va">n</span>,sigma<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span><span class="op">)</span> <span class="co"># X ~ N(0,I_p)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dimnames.html" class="external-link">dimnames</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">n</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"X"</span>, <span class="fl">1</span><span class="op">:</span><span class="va">p</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span><span class="op">)</span> <span class="co"># Rename columns of X</span></span>
<span></span>
<span><span class="va">eps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span>, sd <span class="op">=</span> <span class="fl">20</span><span class="op">)</span> <span class="co"># Error</span></span>
<span></span>
<span><span class="va">beta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="va">p_star</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="va">p</span><span class="op">-</span><span class="va">p_star</span><span class="op">)</span><span class="op">)</span>,ncol<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="co"># Beta = Heaviside function</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">beta</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span> <span class="co"># Rename rows of X</span></span>
<span></span>
<span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">X</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">beta</span><span class="op">)</span><span class="op">**</span><span class="fl">3</span> <span class="op">+</span> <span class="va">eps</span> <span class="co"># The model</span></span></code></pre></div>
<p>We can now plot Y versus the reconstructed index <span class="math inline">\(X\beta\)</span></p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">X</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">beta</span>, <span class="va">Y</span>, xlab <span class="op">=</span> <span class="st">"true index"</span><span class="op">)</span></span></code></pre></div>
<p><img src="SIRthresholded_files/figure-html/unnamed-chunk-2-1.png" width="300px" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="create-a-sir-model">Create a SIR model<a class="anchor" aria-label="anchor" href="#create-a-sir-model"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://clement-w.github.io/SIRthresholded/">SIRthresholded</a></span><span class="op">)</span></span></code></pre></div>
<p>The <code>SIR</code> function is applied to these data.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res_SIR</span> <span class="op">=</span> <span class="fu"><a href="../reference/SIR.html">SIR</a></span><span class="op">(</span>Y <span class="op">=</span> <span class="va">Y</span>, X <span class="op">=</span> <span class="va">X</span>, H <span class="op">=</span> <span class="fl">10</span>,graph <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>The object <code>res_SIR</code> is an object of class
<code>SIR</code> and contains many numerical results (see ?SIR for more
details), summarized in the S3 methods <code>print</code> and
<code>summary</code>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res_SIR</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; SIR(Y = Y, X = X, H = 10, graph = FALSE)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ===== Sliced Inverse Regression ===== </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of observations: 200 </span></span>
<span><span class="co">#&gt; Number of variables in X: 30 </span></span>
<span><span class="co">#&gt; Number of slices: 10 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Results of EDR directions estimation:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     Estimated direction</span></span>
<span><span class="co">#&gt; X1              0.34400</span></span>
<span><span class="co">#&gt; X2              0.36600</span></span>
<span><span class="co">#&gt; X3              0.33200</span></span>
<span><span class="co">#&gt; X4              0.32000</span></span>
<span><span class="co">#&gt; X5              0.26300</span></span>
<span><span class="co">#&gt; X6              0.30500</span></span>
<span><span class="co">#&gt; X7              0.27400</span></span>
<span><span class="co">#&gt; X8              0.23600</span></span>
<span><span class="co">#&gt; X9              0.31200</span></span>
<span><span class="co">#&gt; X10             0.30600</span></span>
<span><span class="co">#&gt; X11             0.12200</span></span>
<span><span class="co">#&gt; X12             0.03120</span></span>
<span><span class="co">#&gt; X13             0.01070</span></span>
<span><span class="co">#&gt; X14             0.01600</span></span>
<span><span class="co">#&gt; X15             0.03300</span></span>
<span><span class="co">#&gt; X16             0.00340</span></span>
<span><span class="co">#&gt; X17             0.04530</span></span>
<span><span class="co">#&gt; X18             0.07400</span></span>
<span><span class="co">#&gt; X19             0.04980</span></span>
<span><span class="co">#&gt; X20            -0.00491</span></span>
<span><span class="co">#&gt; X21             0.07130</span></span>
<span><span class="co">#&gt; X22             0.02870</span></span>
<span><span class="co">#&gt; X23            -0.08520</span></span>
<span><span class="co">#&gt; X24             0.08890</span></span>
<span><span class="co">#&gt; X25            -0.01830</span></span>
<span><span class="co">#&gt; X26            -0.00849</span></span>
<span><span class="co">#&gt; X27             0.00212</span></span>
<span><span class="co">#&gt; X28            -0.00874</span></span>
<span><span class="co">#&gt; X29            -0.05090</span></span>
<span><span class="co">#&gt; X30            -0.00886</span></span></code></pre>
<p>You can now access the estimation of the EDR direction with
<code>res_SIR$b</code>. Thus, it is possible to compute the correlation
between <span class="math inline">\(\beta\)</span> and <span class="math inline">\(\hat{b}\)</span> :</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">beta</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">res_SIR</span><span class="op">$</span><span class="va">b</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; [1] 0.9509708</span></span></code></pre>
<p>Here are the two graphical outputs obtained with the method
<code>plot</code> of the objects of class <code>SIR</code>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res_SIR</span>,choice<span class="op">=</span><span class="st">"estim_ind"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res_SIR</span>,choice<span class="op">=</span><span class="st">"eigvals"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="SIRthresholded_files/figure-html/unnamed-chunk-7-1.png" alt=" " width="300px"><img src="SIRthresholded_files/figure-html/unnamed-chunk-7-2.png" alt=" " width="300px"><p class="caption">
</p>
</div>
<p>The first plot shows the reconstructed index by plotting <span class="math inline">\(Y\)</span> versus <span class="math inline">\(X\hat{b}\)</span> with <span class="math inline">\(\hat{b}\)</span> the estimated <span class="math inline">\(EDR\)</span> direction.</p>
<p>The second one shows the ten largest eigenvalues of the interest
matrix. The <span class="math inline">\(EDR\)</span> direction is the
eigenvector <span class="math inline">\(\hat{b}\)</span> associated with
the largest eigenvalue. This plot can be useful to check if the largest
eigenvalues are very close or not. In the case where they are close, it
could be interesting to try to choose the second or third largest
eigenvector to reconstruct the index. You can access the interest matrix
with <code>res_SIR$M1</code>, and then compute the eigenvectors and
eigenvalues with the function <code><a href="https://rdrr.io/r/base/eigen.html" class="external-link">eigen()</a></code>.</p>
<p>By looking at <span class="math inline">\(\hat{b}\)</span>, we notice
that the coefficient associated to some variables are close to <span class="math inline">\(0\)</span>. We assume that some variables are
useless and that it would be interesting to do variable selection.</p>
</div>
<div class="section level3">
<h3 id="use-optimally-thresholded-sir">Use optimally thresholded SIR<a class="anchor" aria-label="anchor" href="#use-optimally-thresholded-sir"></a>
</h3>
<p>An other approach is to directly use the optimally thresholded
version of <span class="math inline">\(SIR\)</span> which will provide
an estimate of the <span class="math inline">\(EDR\)</span> direction,
and select the relevant variables. Let’s start with <span class="math inline">\(ST-SIR\)</span> (soft thresholded SIR) with 100
<span class="math inline">\(\lambda\)</span> values to test :</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res_STSIR</span> <span class="op">=</span> <span class="fu"><a href="../reference/SIR_threshold_opt.html">SIR_threshold_opt</a></span><span class="op">(</span>Y<span class="op">=</span><span class="va">Y</span>, X<span class="op">=</span><span class="va">X</span>, H<span class="op">=</span><span class="fl">10</span>, n_lambda<span class="op">=</span><span class="fl">100</span>, thresholding<span class="op">=</span><span class="st">"soft"</span>, graph<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>The object <code>res_STSIR</code> is an object of class
<code>SIR_threshold_opt</code> and contains many numerical results (see
?SIR_threshold_opt for more details), summarized in the S3 methods
<code>print</code> and <code>summary</code>.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res_STSIR</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; SIR_threshold_opt(Y = Y, X = X, H = 10, n_lambda = 100, thresholding = "soft",     graph = FALSE)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ===== Optimally Thresholded Sliced Inverse Regression ===== </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of observations: 200 </span></span>
<span><span class="co">#&gt; Number of variables in X: 30 </span></span>
<span><span class="co">#&gt; Number of slices: 10 </span></span>
<span><span class="co">#&gt; Testing: 100 lambda between 0 and 0.112 </span></span>
<span><span class="co">#&gt; Optimal thresholding parameter lambda : 0.0717 </span></span>
<span><span class="co">#&gt; Thresholding method: soft </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of selected variables =  10  over the  30  available variables</span></span>
<span><span class="co">#&gt; List of relevant variables: X1,X2,X3,X4,X5,X6,X7,X8,X9,X10 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Results of EDR directions estimation:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     Estimated direction</span></span>
<span><span class="co">#&gt; X1               -0.374</span></span>
<span><span class="co">#&gt; X2               -0.625</span></span>
<span><span class="co">#&gt; X3               -0.369</span></span>
<span><span class="co">#&gt; X4               -0.200</span></span>
<span><span class="co">#&gt; X5               -0.216</span></span>
<span><span class="co">#&gt; X6               -0.163</span></span>
<span><span class="co">#&gt; X7               -0.193</span></span>
<span><span class="co">#&gt; X8               -0.101</span></span>
<span><span class="co">#&gt; X9               -0.319</span></span>
<span><span class="co">#&gt; X10              -0.267</span></span>
<span><span class="co">#&gt; X11               0.000</span></span>
<span><span class="co">#&gt; X12               0.000</span></span>
<span><span class="co">#&gt; X13               0.000</span></span>
<span><span class="co">#&gt; X14               0.000</span></span>
<span><span class="co">#&gt; X15               0.000</span></span>
<span><span class="co">#&gt; X16               0.000</span></span>
<span><span class="co">#&gt; X17               0.000</span></span>
<span><span class="co">#&gt; X18               0.000</span></span>
<span><span class="co">#&gt; X19               0.000</span></span>
<span><span class="co">#&gt; X20               0.000</span></span>
<span><span class="co">#&gt; X21               0.000</span></span>
<span><span class="co">#&gt; X22               0.000</span></span>
<span><span class="co">#&gt; X23               0.000</span></span>
<span><span class="co">#&gt; X24               0.000</span></span>
<span><span class="co">#&gt; X25               0.000</span></span>
<span><span class="co">#&gt; X26               0.000</span></span>
<span><span class="co">#&gt; X27               0.000</span></span>
<span><span class="co">#&gt; X28               0.000</span></span>
<span><span class="co">#&gt; X29               0.000</span></span>
<span><span class="co">#&gt; X30               0.000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Estimate a new SIR model on the relevant variables with :</span></span>
<span><span class="co">#&gt;   SIR(Y=res_STSIR$Y, X=res_STSIR$X_reduced, H=res_STSIR$H)</span></span></code></pre>
<p>Here are some graphical outputs obtained with the method
<code>plot</code> of the objects of class
<code>SIR_threshold_opt</code>.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res_STSIR</span>,choice<span class="op">=</span><span class="st">"cos2_selec"</span><span class="op">)</span></span></code></pre></div>
<p><img src="SIRthresholded_files/figure-html/unnamed-chunk-10-1.png" width="450px" style="display: block; margin: auto;"></p>
<p>This plot shows the evolution of <span class="math inline">\(cos^2(\hat{b}_{ST-SIR},\hat{b}_{SIR})\)</span> and
the percentage of variables selected by the model, according to the
value of <span class="math inline">\(\lambda\)</span>. This graph is
very informative as it shows the compromise between variable selection
and distortion of the estimated direction. The <span class="math inline">\(\hat{\lambda}_{opt}\)</span> must provide a
balance between these two.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res_STSIR</span>,choice<span class="op">=</span><span class="st">"opt_lambda"</span><span class="op">)</span></span></code></pre></div>
<p><img src="SIRthresholded_files/figure-html/unnamed-chunk-11-1.png" width="450px" style="display: block; margin: auto;"></p>
<p>This plot shows how the optimal lambda has been chosen. For each
feature of <span class="math inline">\(X\)</span>, the percentage of
<span class="math inline">\(\lambda\)</span> associated with a selection
of this feature is stored in a vector, which is sorted and plotted here.
Thanks to <code><a href="https://rdrr.io/pkg/strucchange/man/breakpoints.html" class="external-link">strucchange::breakpoints</a></code>, a breakpoint is found
in this sorted vector, which allows to deduce the <span class="math inline">\(\lambda_{opt}\)</span> as explained in the <a href="#overview">Overview</a>.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res_STSIR</span>,choice<span class="op">=</span><span class="st">"regul_path"</span><span class="op">)</span></span></code></pre></div>
<p><img src="SIRthresholded_files/figure-html/unnamed-chunk-12-1.png" width="500px" style="display: block; margin: auto;"></p>
<p>This plot shows the regularization path of <span class="math inline">\(\hat{b}\)</span> according to the value of <span class="math inline">\(\lambda\)</span>. Here, we can see that according
to <span class="math inline">\(\lambda\)</span>, some variables rapidly
converge to 0, whereas the 10 relevant variables are more difficult to
toggle to 0.</p>
<p>Then, let’s plot plot Y versus the estimated first index <span class="math inline">\(X\hat{b}\)</span>.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res_STSIR</span>,choice<span class="op">=</span><span class="st">"estim_ind"</span><span class="op">)</span></span></code></pre></div>
<p><img src="SIRthresholded_files/figure-html/unnamed-chunk-13-1.png" width="300px" style="display: block; margin: auto;"></p>
<p>We can also see some graphical outputs of
<code>SIR_threshold_opt</code> with hard thresholding :</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res_HTSIR</span> <span class="op">=</span> <span class="fu"><a href="../reference/SIR_threshold_opt.html">SIR_threshold_opt</a></span><span class="op">(</span>Y<span class="op">=</span><span class="va">Y</span>, X<span class="op">=</span><span class="va">X</span>, H<span class="op">=</span><span class="fl">10</span>, n_lambda<span class="op">=</span><span class="fl">100</span>, thresholding<span class="op">=</span><span class="st">"hard"</span>, graph<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res_HTSIR</span>,choice<span class="op">=</span><span class="st">"cos2_selec"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res_HTSIR</span>,choice<span class="op">=</span><span class="st">"regul_path"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="SIRthresholded_files/figure-html/unnamed-chunk-14-1.png" alt=" " width="330px"><img src="SIRthresholded_files/figure-html/unnamed-chunk-14-2.png" alt=" " width="330px"><p class="caption">
</p>
</div>
<p>The hard thresholding method results in a more abrupt variable
selection according to the <span class="math inline">\(\lambda\)</span>s, wich explains that the curves
are straighter with bigger jumps between values.</p>
</div>
<div class="section level3">
<h3 id="estimate-a-new-sir-model-on-the-relevant-variables">Estimate a new SIR model on the relevant variables<a class="anchor" aria-label="anchor" href="#estimate-a-new-sir-model-on-the-relevant-variables"></a>
</h3>
<p>As the soft thresholding deforms the matrix of interest with the
<span class="math inline">\(\lambda\)</span> parameter, the estimation
of <span class="math inline">\(\hat{b}\)</span> is biased. That is why,
at the end of the S3 summary method, it is proposed to create a new SIR
model based only on the relevant variables, selected by the method.
Let’s copy paste the command line from the result of
<code>SIR_threshold_opt</code> and see the results:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res_SIR_pstar</span> <span class="op">=</span> <span class="fu"><a href="../reference/SIR.html">SIR</a></span><span class="op">(</span>Y<span class="op">=</span><span class="va">res_STSIR</span><span class="op">$</span><span class="va">Y</span>, X<span class="op">=</span><span class="va">res_STSIR</span><span class="op">$</span><span class="va">X_reduced</span>, H<span class="op">=</span><span class="va">res_STSIR</span><span class="op">$</span><span class="va">H</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res_SIR_pstar</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; SIR(Y = res_STSIR$Y, X = res_STSIR$X_reduced, H = res_STSIR$H)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ===== Sliced Inverse Regression ===== </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of observations: 200 </span></span>
<span><span class="co">#&gt; Number of variables in X: 10 </span></span>
<span><span class="co">#&gt; Number of slices: 10 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Results of EDR directions estimation:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     Estimated direction</span></span>
<span><span class="co">#&gt; X1               -0.370</span></span>
<span><span class="co">#&gt; X2               -0.359</span></span>
<span><span class="co">#&gt; X3               -0.348</span></span>
<span><span class="co">#&gt; X4               -0.315</span></span>
<span><span class="co">#&gt; X5               -0.291</span></span>
<span><span class="co">#&gt; X6               -0.282</span></span>
<span><span class="co">#&gt; X7               -0.288</span></span>
<span><span class="co">#&gt; X8               -0.255</span></span>
<span><span class="co">#&gt; X9               -0.324</span></span>
<span><span class="co">#&gt; X10              -0.313</span></span></code></pre>
<p>Let’s plot Y versus the estimated first index <span class="math inline">\(X\hat{b}\)</span></p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res_SIR_pstar</span>,choice<span class="op">=</span><span class="st">"estim_ind"</span><span class="op">)</span></span></code></pre></div>
<p><img src="SIRthresholded_files/figure-html/unnamed-chunk-16-1.png" width="300px" style="display: block; margin: auto;"></p>
<p>We directly notice that this estimated index is very close to the
theoretical index plotted earlier.</p>
<p>As done previously, let’s compute the correlation between <span class="math inline">\(\beta\)</span> and <span class="math inline">\(\hat{b}_{ST-SIR-p^\star}\)</span> and compare it
with the results of classic SIR. As the real <span class="math inline">\(\beta\)</span> vector has a length of 30 and <span class="math inline">\(\hat{b}_{ST-SIR-p^\star}\)</span> has a length of
10, we need to create a new vector of size 30 to be able to compare
them.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">b_extended</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="va">p</span><span class="op">)</span>,nrow<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="co"># Create the empty vector</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">b_extended</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span> <span class="co"># Assign the colnames of X</span></span>
<span><span class="co"># Assign the values of b_extended according to the colnames</span></span>
<span><span class="va">b_extended</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">b_extended</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">res_SIR_pstar</span><span class="op">$</span><span class="va">b</span><span class="op">)</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="va">res_SIR_pstar</span><span class="op">$</span><span class="va">b</span></span></code></pre></div>
<p>Let’s compute the correlation :</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">beta</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">b_extended</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; [1] -0.9908271</span></span></code></pre>
<p>We notice that the estimation of <span class="math inline">\(\beta\)</span> is better than the classic <span class="math inline">\(SIR\)</span> method (95% for <span class="math inline">\(SIR\)</span> and 99% for <span class="math inline">\(ST-SIR-p^\star\)</span>). The 20 useless variables
have been eliminated, and the estimation of the <span class="math inline">\(EDR\)</span> direction is very good.</p>
<p>Wether using hard or soft thresholding, it is always relevent to
create a new <span class="math inline">\(SIR\)</span> model considering
only the relevant variables. It allows to improve the estimation of the
<span class="math inline">\(EDR\)</span> direction.</p>
</div>
<div class="section level3">
<h3 id="sir-thresholded-with-a-given-lambda-parameter">SIR thresholded with a given <span class="math inline">\(\lambda\)</span> parameter<a class="anchor" aria-label="anchor" href="#sir-thresholded-with-a-given-lambda-parameter"></a>
</h3>
<p>If you want to experiment the thresholding operation by yourself, you
can call <code>SIR_threshold</code> and give your own <span class="math inline">\(\lambda\)</span> to threshold the interest matrix
:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res_SIR_thresh</span> <span class="op">=</span> <span class="fu"><a href="../reference/SIR_threshold.html">SIR_threshold</a></span><span class="op">(</span><span class="va">Y</span>, <span class="va">X</span>, H <span class="op">=</span> <span class="fl">10</span>, lambda <span class="op">=</span> <span class="fl">0.04</span>, thresholding <span class="op">=</span> <span class="st">"hard"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res_SIR_thresh</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; SIR_threshold(Y = Y, X = X, H = 10, lambda = 0.04, thresholding = "hard")</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ===== Thresholded Sliced Inverse Regression ===== </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of observations: 200 </span></span>
<span><span class="co">#&gt; Number of variables in X: 30 </span></span>
<span><span class="co">#&gt; Number of slices: 10 </span></span>
<span><span class="co">#&gt; Thresholding parameter lambda: 0.04 </span></span>
<span><span class="co">#&gt; Thresholding method: hard</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of selected variables =  15  over the  30  available variables</span></span>
<span><span class="co">#&gt; List of relevant variables: X1,X2,X3,X4,X5,X6,X7,X8,X9,X10,X11,X14,X15,X18,X23 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Results of EDR directions estimation:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     Estimated direction</span></span>
<span><span class="co">#&gt; X1             -0.36200</span></span>
<span><span class="co">#&gt; X2             -0.37300</span></span>
<span><span class="co">#&gt; X3             -0.33400</span></span>
<span><span class="co">#&gt; X4             -0.33400</span></span>
<span><span class="co">#&gt; X5             -0.26900</span></span>
<span><span class="co">#&gt; X6             -0.32100</span></span>
<span><span class="co">#&gt; X7             -0.27500</span></span>
<span><span class="co">#&gt; X8             -0.22600</span></span>
<span><span class="co">#&gt; X9             -0.31100</span></span>
<span><span class="co">#&gt; X10            -0.31700</span></span>
<span><span class="co">#&gt; X11            -0.07260</span></span>
<span><span class="co">#&gt; X12             0.00000</span></span>
<span><span class="co">#&gt; X13             0.00000</span></span>
<span><span class="co">#&gt; X14             0.00387</span></span>
<span><span class="co">#&gt; X15            -0.01610</span></span>
<span><span class="co">#&gt; X16             0.00000</span></span>
<span><span class="co">#&gt; X17             0.00000</span></span>
<span><span class="co">#&gt; X18            -0.01850</span></span>
<span><span class="co">#&gt; X19             0.00000</span></span>
<span><span class="co">#&gt; X20             0.00000</span></span>
<span><span class="co">#&gt; X21             0.00000</span></span>
<span><span class="co">#&gt; X22             0.00000</span></span>
<span><span class="co">#&gt; X23             0.03170</span></span>
<span><span class="co">#&gt; X24             0.00000</span></span>
<span><span class="co">#&gt; X25             0.00000</span></span>
<span><span class="co">#&gt; X26             0.00000</span></span>
<span><span class="co">#&gt; X27             0.00000</span></span>
<span><span class="co">#&gt; X28             0.00000</span></span>
<span><span class="co">#&gt; X29             0.00000</span></span>
<span><span class="co">#&gt; X30             0.00000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Estimate a new SIR model on the relevant variables with :</span></span>
<span><span class="co">#&gt;   SIR(Y=res_SIR_thresh$Y, X=res_SIR_thresh$X_reduced, H=res_SIR_thresh$H)</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="test-the-robustness-of-the-model-with-bootstrapping">Test the robustness of the model with bootstrapping<a class="anchor" aria-label="anchor" href="#test-the-robustness-of-the-model-with-bootstrapping"></a>
</h3>
<p>To test the robustness of the model, it is relevant to perform
bootstrapping. This method is even more relevant when the sample size is
small. Lets call <code>SIR_threshold_bootstrap</code> on the data, with
10 replications (only 10 to simplify vignettes building), a bootstrapped
sample size multiplied by 2 (k=2) and the hard thresholding method :</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res_SIR_boot</span> <span class="op">=</span> <span class="fu"><a href="../reference/SIR_threshold_bootstrap.html">SIR_threshold_bootstrap</a></span><span class="op">(</span><span class="va">Y</span>,<span class="va">X</span>,H<span class="op">=</span><span class="fl">10</span>,n_lambda<span class="op">=</span><span class="fl">100</span>,thresholding<span class="op">=</span><span class="st">"hard"</span>, n_replications<span class="op">=</span><span class="fl">10</span>,k<span class="op">=</span><span class="fl">2</span>,graph <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; [1] "Replication 5 / 10"</span></span>
<span><span class="co">#&gt; [1] "Replication 10 / 10"</span></span></code></pre>
<p>The object <code>res_SIR_boot</code> is an object of class
<code>SIR_threshold_bootstrap</code> and contains many numerical results
(see ?SIR_threshold_bootstrap for more details), summarized in the S3
methods <code>print</code> and <code>summary</code>.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res_SIR_boot</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; SIR_threshold_bootstrap(Y = Y, X = X, H = 10, thresholding = "hard",     n_replications = 10, graph = FALSE, n_lambda = 100, k = 2)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ===== Optimally Thresholded Sliced Inverse Regression on bootstrapped replications ===== </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of observations: 200 </span></span>
<span><span class="co">#&gt; Number of variables in X: 30 </span></span>
<span><span class="co">#&gt; Number of slices: 10 </span></span>
<span><span class="co">#&gt; Number of bootstraped replications: 10 </span></span>
<span><span class="co">#&gt; Optimal thresholding parameter lambda : 0.0717 </span></span>
<span><span class="co">#&gt; Thresholding method: hard</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of selected variables =  10  over the  30  available variables</span></span>
<span><span class="co">#&gt; List of relevant variables: X1,X2,X3,X4,X5,X6,X7,X8,X9,X10 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Results of EDR directions estimation:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     Estimated direction</span></span>
<span><span class="co">#&gt; X1                0.399</span></span>
<span><span class="co">#&gt; X2                0.363</span></span>
<span><span class="co">#&gt; X3                0.395</span></span>
<span><span class="co">#&gt; X4                0.390</span></span>
<span><span class="co">#&gt; X5                0.196</span></span>
<span><span class="co">#&gt; X6                0.284</span></span>
<span><span class="co">#&gt; X7                0.197</span></span>
<span><span class="co">#&gt; X8                0.135</span></span>
<span><span class="co">#&gt; X9                0.355</span></span>
<span><span class="co">#&gt; X10               0.315</span></span>
<span><span class="co">#&gt; X11               0.000</span></span>
<span><span class="co">#&gt; X12               0.000</span></span>
<span><span class="co">#&gt; X13               0.000</span></span>
<span><span class="co">#&gt; X14               0.000</span></span>
<span><span class="co">#&gt; X15               0.000</span></span>
<span><span class="co">#&gt; X16               0.000</span></span>
<span><span class="co">#&gt; X17               0.000</span></span>
<span><span class="co">#&gt; X18               0.000</span></span>
<span><span class="co">#&gt; X19               0.000</span></span>
<span><span class="co">#&gt; X20               0.000</span></span>
<span><span class="co">#&gt; X21               0.000</span></span>
<span><span class="co">#&gt; X22               0.000</span></span>
<span><span class="co">#&gt; X23               0.000</span></span>
<span><span class="co">#&gt; X24               0.000</span></span>
<span><span class="co">#&gt; X25               0.000</span></span>
<span><span class="co">#&gt; X26               0.000</span></span>
<span><span class="co">#&gt; X27               0.000</span></span>
<span><span class="co">#&gt; X28               0.000</span></span>
<span><span class="co">#&gt; X29               0.000</span></span>
<span><span class="co">#&gt; X30               0.000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Estimate a new SIR model on the relevant variables with :</span></span>
<span><span class="co">#&gt;   SIR(Y=res_SIR_boot$Y, X=res_SIR_boot$X_reduced, H=res_SIR_boot$H)</span></span></code></pre>
<p>Here are some graphical outputs obtained with the method
<code>plot</code> of the objects of class
<code>SIR_threshold_bootstrap</code>.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res_SIR_boot</span>,choice<span class="op">=</span><span class="st">"size"</span><span class="op">)</span></span></code></pre></div>
<p><img src="SIRthresholded_files/figure-html/unnamed-chunk-22-1.png" width="400px" style="display: block; margin: auto;"></p>
<p>This barplot shows the distribution of the number of variables keeped
by the model.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res_SIR_boot</span>,choice<span class="op">=</span><span class="st">"selec_var"</span><span class="op">)</span></span></code></pre></div>
<p><img src="SIRthresholded_files/figure-html/unnamed-chunk-23-1.png" width="400px" style="display: block; margin: auto;"></p>
<p>This barplot shows the percentage of selection by the model for every
variables.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res_SIR_boot</span>,choice<span class="op">=</span><span class="st">"lambdas_replic"</span><span class="op">)</span></span></code></pre></div>
<p><img src="SIRthresholded_files/figure-html/unnamed-chunk-24-1.png" width="400px" style="display: block; margin: auto;"></p>
<p>This boxplot shows the distribution of the <span class="math inline">\(\lambda_{opt}\)</span> choosen over the
replications. Moreover, the <span class="math inline">\(\lambda_{opt}\)</span> that has been selected (see
how in <a href="#sir_threshold_bootstrap-function">the overview</a>) is
indicated with a purple horizontal line.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res_SIR_boot</span>,choice<span class="op">=</span><span class="st">"coefs_b"</span><span class="op">)</span></span></code></pre></div>
<p><img src="SIRthresholded_files/figure-html/unnamed-chunk-25-1.png" width="400px" style="display: block; margin: auto;"></p>
<p>This plot shows the distribution of every coefficients of the <span class="math inline">\(\hat{b}\)</span> computed over the replications.
The final coefficients of <span class="math inline">\(\hat{b}\)</span>
that have been computed (see how in <a href="#sir_threshold_bootstrap-function">the overview</a>) are indicated
with a purple dot.</p>
<p>As done with <code>SIR_threshold_opt</code>, we can also create a new
SIR model considering only the relevant variables.</p>
</div>
</div>
<div class="section level2">
<h2 id="example-with-wine-dataset">Example with Wine dataset<a class="anchor" aria-label="anchor" href="#example-with-wine-dataset"></a>
</h2>
<p>In this section :</p>
<ul>
<li>
<a href="#the-data">(1)</a> Load the wine dataset.</li>
<li>
<a href="#a-first-sir-model">(2)</a> A first SIR model optimally
thresholded is applied to the data.</li>
<li>
<a href="#perform-bootstrap">(3)</a> A bootstrapped version of SIR
optimally thresholded is applied to the data.</li>
<li>
<a href="#thresholding-with-a-custom-lambda">(4)</a> A SIR model
thresholded with a custom <span class="math inline">\(\lambda\)</span>
is applied to the data.</li>
<li>
<a href="#estimate-a-sir-model-on-the-relevant-variables">(5)</a> A
SIR model is applied on the relevant variables</li>
<li>
<a href="#additional-study">(6)</a> Additional study of the quality
of the model with multiple linear regression</li>
<li>
<a href="#concluding-remarks">(7)</a> Concluding remarks</li>
</ul>
<div class="section level3">
<h3 id="the-data">The data<a class="anchor" aria-label="anchor" href="#the-data"></a>
</h3>
<p>For this example, we chose the wine dataset from the UCI machine
learning repository (the official link is not working anymore, please
find another version of the dataset on that link <a href="https://gist.githubusercontent.com/tijptjik/9408623/raw/b237fa5848349a14a14e5d4107dc7897c21951f5/wine.csv" class="external-link uri">https://gist.githubusercontent.com/tijptjik/9408623/raw/b237fa5848349a14a14e5d4107dc7897c21951f5/wine.csv</a>).
As explained on the page description of the dataset, these data are the
results of a chemical analysis of wines grown in the same region in
Italy. The analysis determined the quantities of 12 constituents found
in the 178 samples of wine. Here, we’ll try to find the relevant
variables in order to perform regression on the response variable
Nonflavanoids according to the 12 other constituents. First, let’s load
the dataset.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wine</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="st">"https://gist.githubusercontent.com/Clement-W/26d99a28ab89929b6321f70a04535451/raw/169a36568d1fc7c5a7c508e8d3e720d5040744cd/wine.csv"</span>, header <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">wine</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Type'</span>, <span class="st">'Alcohol'</span>, <span class="st">'Malic'</span>, <span class="st">'Ash'</span>, <span class="st">'Alcalinity'</span>, <span class="st">'Magnesium'</span>, </span>
<span>                    <span class="st">'Phenols'</span>, <span class="st">'Flavanoids'</span>, <span class="st">'Nonflavanoids'</span>, <span class="st">'Proanthocyanins'</span>, </span>
<span>                    <span class="st">'Color'</span>, <span class="st">'Hue'</span>, <span class="st">'Dilution'</span>, <span class="st">'Proline'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Extract the response variable</span></span>
<span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="va">wine</span><span class="op">$</span><span class="va">Nonflavanoids</span></span>
<span><span class="co"># Remove the response variable (Nonflavanoids) and the class information (type of cultivars)</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="va">wine</span><span class="op">[</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">wine</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Type"</span>,<span class="st">"Nonflavanoids"</span><span class="op">)</span><span class="op">)</span><span class="op">]</span> </span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">Y</span>,<span class="va">X</span><span class="op">)</span>,<span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt;      Y Alcohol Malic  Ash Alcalinity Magnesium Phenols Flavanoids</span></span>
<span><span class="co">#&gt; 1 0.28   14.23  1.71 2.43       15.6       127    2.80       3.06</span></span>
<span><span class="co">#&gt; 2 0.26   13.20  1.78 2.14       11.2       100    2.65       2.76</span></span>
<span><span class="co">#&gt; 3 0.30   13.16  2.36 2.67       18.6       101    2.80       3.24</span></span>
<span><span class="co">#&gt;   Proanthocyanins Color  Hue Dilution Proline</span></span>
<span><span class="co">#&gt; 1            2.29  5.64 1.04     3.92    1065</span></span>
<span><span class="co">#&gt; 2            1.28  4.38 1.05     3.40    1050</span></span>
<span><span class="co">#&gt; 3            2.81  5.68 1.03     3.17    1185</span></span></code></pre>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; [1] 178  12</span></span></code></pre>
<p>The X data contains 178 samples of 12 variables. As suggested in the
description page of this dataset, we’ll standardise the variables with
the <code><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale()</a></code> method. Here, scaling the data is mandatory to
ensure that the SIR method works properly.</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">X</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span></span>
<span><span class="va">Y</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="a-first-sir-model">A first SIR model<a class="anchor" aria-label="anchor" href="#a-first-sir-model"></a>
</h3>
<p>Now, we can use <code>SIR_threshold_opt</code> to do variable
selection with an optimal thresholding parameter. The sample size is
relatively small. To improve the estimations of <span class="math inline">\(p_h\)</span> and <span class="math inline">\(m_h\)</span> in the SIR method (more details in <a href="#how-sir-and-sir-thresholded-works">the first part of this
vignette</a>), we reduce the number of slices to 5, so there is more
sample in each slices.</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res1</span> <span class="op">=</span> <span class="fu"><a href="../reference/SIR_threshold_opt.html">SIR_threshold_opt</a></span><span class="op">(</span>Y<span class="op">=</span><span class="va">Y</span>, X<span class="op">=</span><span class="va">X</span>, H<span class="op">=</span><span class="fl">5</span>, n_lambda<span class="op">=</span><span class="fl">300</span>, thresholding<span class="op">=</span><span class="st">"soft"</span>, graph<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; SIR_threshold_opt(Y = Y, X = X, H = 5, n_lambda = 300, thresholding = "soft",     graph = FALSE)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ===== Optimally Thresholded Sliced Inverse Regression ===== </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of observations: 178 </span></span>
<span><span class="co">#&gt; Number of variables in X: 12 </span></span>
<span><span class="co">#&gt; Number of slices: 5 </span></span>
<span><span class="co">#&gt; Testing: 300 lambda between 0 and 0.241 </span></span>
<span><span class="co">#&gt; Optimal thresholding parameter lambda : 0.154 </span></span>
<span><span class="co">#&gt; Thresholding method: soft </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of selected variables =  2  over the  12  available variables</span></span>
<span><span class="co">#&gt; List of relevant variables: Ash,Flavanoids </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Results of EDR directions estimation:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                 Estimated direction</span></span>
<span><span class="co">#&gt; Alcohol                       0.000</span></span>
<span><span class="co">#&gt; Malic                         0.000</span></span>
<span><span class="co">#&gt; Ash                          -0.127</span></span>
<span><span class="co">#&gt; Alcalinity                    0.000</span></span>
<span><span class="co">#&gt; Magnesium                     0.000</span></span>
<span><span class="co">#&gt; Phenols                       0.000</span></span>
<span><span class="co">#&gt; Flavanoids                    0.992</span></span>
<span><span class="co">#&gt; Proanthocyanins               0.000</span></span>
<span><span class="co">#&gt; Color                         0.000</span></span>
<span><span class="co">#&gt; Hue                           0.000</span></span>
<span><span class="co">#&gt; Dilution                      0.000</span></span>
<span><span class="co">#&gt; Proline                       0.000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Estimate a new SIR model on the relevant variables with :</span></span>
<span><span class="co">#&gt;   SIR(Y=res1$Y, X=res1$X_reduced, H=res1$H)</span></span></code></pre>
<p>In this first model, 2 variables are selected : Ash and Flavanoids.
Let’s explore the graphs to better understand what is going on.</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res1</span>,choice<span class="op">=</span><span class="st">"estim_ind"</span><span class="op">)</span></span></code></pre></div>
<p><img src="SIRthresholded_files/figure-html/unnamed-chunk-29-1.png" width="300px" style="display: block; margin: auto;"></p>
<p>We first note that the model is very noisy. However, we still notice
a linear tendency between the estimated index and Y.</p>
<p>Let’s now focus on variable selection.</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res1</span>,choice<span class="op">=</span><span class="st">"cos2_selec"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res1</span>,choice<span class="op">=</span><span class="st">"regul_path"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="SIRthresholded_files/figure-html/unnamed-chunk-30-1.png" alt=" " width="400px"><img src="SIRthresholded_files/figure-html/unnamed-chunk-30-2.png" alt=" " width="400px"><p class="caption">
</p>
</div>
<p>These two graphs helps us to understand the link between variable
selection (the coefficients of <span class="math inline">\(\hat{b}\)</span>) and <span class="math inline">\(\lambda\)</span>. Here, the <span class="math inline">\(\lambda_{opt}\)</span> allows to select 2
variables. In the first plot, we notice that if <span class="math inline">\(\lambda\)</span> were a bit less than <span class="math inline">\(\lambda_{opt}\)</span>, we could have selected 2
or 3 more variables, while improving the estimation of <span class="math inline">\(\hat{b}\)</span>. In fact, in the second plot, we
notice that the coefficients of <span class="math inline">\(\hat{b}\)</span> associated to the variables
Dillution, Magnesium and Hue are set to 0 by <span class="math inline">\(\lambda_{opt}\)</span>.</p>
</div>
<div class="section level3">
<h3 id="perform-bootstrap">Perform Bootstrap<a class="anchor" aria-label="anchor" href="#perform-bootstrap"></a>
</h3>
<p>As the data is noisy, the sample size is small, and the <span class="math inline">\(\lambda_{opt}\)</span> obtained with
<code>SIR_threshold_opt</code> is questionable, it is relevant to
perform SIR_threshold_opt on bootstrapped replications of the dataset.
Let’s perform 500 replications, with a bootstrapped sample size
multiplied by 2 :</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># To lighten the build of the vignette, the result of this command was saved into a RData file.</span></span>
<span><span class="co">#res2 = SIR_threshold_bootstrap(Y=Y, X=X, H=5, n_lambda=200, thresholding="hard", n_replications = 500 , graph=FALSE)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span><span class="st">"../R/sysdata.rda"</span><span class="op">)</span> <span class="co"># load res2</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; SIR_threshold_bootstrap(Y = scale(Y), X = scale(X), H = 5, n_replications = 500,     n_lambda = 200)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ===== Optimally Thresholded Sliced Inverse Regression on bootstrapped replications ===== </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of observations: 178 </span></span>
<span><span class="co">#&gt; Number of variables in X: 12 </span></span>
<span><span class="co">#&gt; Number of slices: 5 </span></span>
<span><span class="co">#&gt; Number of bootstraped replications: 500 </span></span>
<span><span class="co">#&gt; Optimal thresholding parameter lambda : 0.146 </span></span>
<span><span class="co">#&gt; Thresholding method: hard</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of selected variables =  2  over the  12  available variables</span></span>
<span><span class="co">#&gt; List of relevant variables: Ash,Flavanoids </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Results of EDR directions estimation:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                 Estimated direction</span></span>
<span><span class="co">#&gt; Alcohol                       0.000</span></span>
<span><span class="co">#&gt; Malic                         0.000</span></span>
<span><span class="co">#&gt; Ash                          -0.436</span></span>
<span><span class="co">#&gt; Alcalinity                    0.000</span></span>
<span><span class="co">#&gt; Magnesium                     0.000</span></span>
<span><span class="co">#&gt; Phenols                       0.000</span></span>
<span><span class="co">#&gt; Flavanoids                    0.900</span></span>
<span><span class="co">#&gt; Proanthocyanins               0.000</span></span>
<span><span class="co">#&gt; Color                         0.000</span></span>
<span><span class="co">#&gt; Hue                           0.000</span></span>
<span><span class="co">#&gt; Dilution                      0.000</span></span>
<span><span class="co">#&gt; Proline                       0.000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Estimate a new SIR model on the relevant variables with :</span></span>
<span><span class="co">#&gt;   SIR(Y=res2$Y, X=res2$X_reduced, H=res2$H)</span></span></code></pre>
<p>Let’s explore some of the graphical outputs :</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res2</span>,choice<span class="op">=</span><span class="st">"size"</span><span class="op">)</span></span></code></pre></div>
<p><img src="SIRthresholded_files/figure-html/unnamed-chunk-32-1.png" width="400px" style="display: block; margin: auto;"></p>
<p>Over the 500 replications, 50% of the models selected 2 variables.
Then, approximately 45% of the models selected 3,4,5 or 6 variables.
Let’s take a look at the percentage of variable selection.</p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res2</span>,choice<span class="op">=</span><span class="st">"selec_var"</span><span class="op">)</span></span></code></pre></div>
<p><img src="SIRthresholded_files/figure-html/unnamed-chunk-33-1.png" width="400px" style="display: block; margin: auto;"></p>
<p>As expected, a large majority of the models have selected the
variables Ash and Flavanoids. But it is interesting to see that 4 other
variables were regularly selected (between 30 and 40% of the
replications) : Magnesium, Phenols, Hue and Dilution. We notice that
these variables were closed to be selected in
<code>SIR_threshold_opt</code>.</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res2</span>,choice<span class="op">=</span><span class="st">"coefs_b"</span><span class="op">)</span></span></code></pre></div>
<p><img src="SIRthresholded_files/figure-html/unnamed-chunk-34-1.png" width="400px" style="display: block; margin: auto;"></p>
<p>Looking at the boxplot of the value of <span class="math inline">\(\hat{b}\)</span> over the 500 replications, we
also find the same results. The coefficients of <span class="math inline">\(\hat{b}\)</span> associated to Magnesium, Phenols,
Hue and Dilution are greater than 0 in median. It would then be
interesting to create a SIR model, that contains these variable.</p>
</div>
<div class="section level3">
<h3 id="thresholding-with-a-custom-lambda">Thresholding with a custom <span class="math inline">\(\lambda\)</span><a class="anchor" aria-label="anchor" href="#thresholding-with-a-custom-lambda"></a>
</h3>
<p>Let’s look at the regularization path plotted earlier, and find the
<span class="math inline">\(\lambda\)</span> which select the 4
potentially relevant variables. By looking at the top axis of the
regularization path, we find the first lambda which select 6 variables,
which is approximately 0.07 :</p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res3</span> <span class="op">=</span> <span class="fu"><a href="../reference/SIR_threshold.html">SIR_threshold</a></span><span class="op">(</span>Y<span class="op">=</span><span class="va">Y</span>, X<span class="op">=</span><span class="va">X</span>, H<span class="op">=</span><span class="fl">5</span>, lambda <span class="op">=</span> <span class="fl">0.071</span>, thresholding<span class="op">=</span><span class="st">"hard"</span>, graph<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res3</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; SIR_threshold(Y = Y, X = X, H = 5, lambda = 0.071, thresholding = "hard",     graph = FALSE)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ===== Thresholded Sliced Inverse Regression ===== </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of observations: 178 </span></span>
<span><span class="co">#&gt; Number of variables in X: 12 </span></span>
<span><span class="co">#&gt; Number of slices: 5 </span></span>
<span><span class="co">#&gt; Thresholding parameter lambda: 0.071 </span></span>
<span><span class="co">#&gt; Thresholding method: hard</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of selected variables =  6  over the  12  available variables</span></span>
<span><span class="co">#&gt; List of relevant variables: Ash,Magnesium,Phenols,Flavanoids,Hue,Dilution </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Results of EDR directions estimation:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                 Estimated direction</span></span>
<span><span class="co">#&gt; Alcohol                       0.000</span></span>
<span><span class="co">#&gt; Malic                         0.000</span></span>
<span><span class="co">#&gt; Ash                           0.321</span></span>
<span><span class="co">#&gt; Alcalinity                    0.000</span></span>
<span><span class="co">#&gt; Magnesium                    -0.322</span></span>
<span><span class="co">#&gt; Phenols                       0.229</span></span>
<span><span class="co">#&gt; Flavanoids                   -0.764</span></span>
<span><span class="co">#&gt; Proanthocyanins               0.000</span></span>
<span><span class="co">#&gt; Color                         0.000</span></span>
<span><span class="co">#&gt; Hue                           0.342</span></span>
<span><span class="co">#&gt; Dilution                     -0.202</span></span>
<span><span class="co">#&gt; Proline                       0.000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Estimate a new SIR model on the relevant variables with :</span></span>
<span><span class="co">#&gt;   SIR(Y=res3$Y, X=res3$X_reduced, H=res3$H)</span></span></code></pre>
<p>Now, the 6 variables are selected with this estimation of <span class="math inline">\(\hat{b}.\)</span>. Let’s estimate a new SIR model
only on these relevant variables.</p>
</div>
<div class="section level3">
<h3 id="estimate-a-sir-model-on-the-relevant-variables">Estimate a SIR model on the relevant variables<a class="anchor" aria-label="anchor" href="#estimate-a-sir-model-on-the-relevant-variables"></a>
</h3>
<p>Let’s copy paste the command from the previous output of the S3
summary method, and plot the estimated index versus Y :</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res4</span> <span class="op">=</span> <span class="fu"><a href="../reference/SIR.html">SIR</a></span><span class="op">(</span>Y<span class="op">=</span><span class="va">res3</span><span class="op">$</span><span class="va">Y</span>, X<span class="op">=</span><span class="va">res3</span><span class="op">$</span><span class="va">X_reduced</span>, H<span class="op">=</span><span class="va">res3</span><span class="op">$</span><span class="va">H</span>, graph <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res4</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; SIR(Y = res3$Y, X = res3$X_reduced, H = res3$H, graph = FALSE)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ===== Sliced Inverse Regression ===== </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of observations: 178 </span></span>
<span><span class="co">#&gt; Number of variables in X: 6 </span></span>
<span><span class="co">#&gt; Number of slices: 5 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Results of EDR directions estimation:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;            Estimated direction</span></span>
<span><span class="co">#&gt; Ash                     -0.388</span></span>
<span><span class="co">#&gt; Magnesium                0.297</span></span>
<span><span class="co">#&gt; Phenols                 -0.250</span></span>
<span><span class="co">#&gt; Flavanoids               0.745</span></span>
<span><span class="co">#&gt; Hue                     -0.194</span></span>
<span><span class="co">#&gt; Dilution                 0.324</span></span></code></pre>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res4</span>,choice<span class="op">=</span><span class="st">"estim_ind"</span><span class="op">)</span></span></code></pre></div>
<p><img src="SIRthresholded_files/figure-html/unnamed-chunk-37-1.png" width="300px" style="display: block; margin: auto;"></p>
<p>We can note that the estimated index seems to be a bit less noisy,
the linear tendency is easier to see.</p>
</div>
<div class="section level3">
<h3 id="additional-study">Additional study<a class="anchor" aria-label="anchor" href="#additional-study"></a>
</h3>
<p>Visually, the link between Y and X seems to be linear. To estimate
the quality of our model, and to evaluate the relevance of the selected
variable, we can build a linear model on the data.</p>
<p>Let’s start with a model containing every variables :</p>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">Y</span><span class="op">~</span><span class="va">X</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = Y ~ X)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">#&gt; -2.11496 -0.41347 -0.00877  0.47458  2.62253 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                    Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)      -3.303e-16  5.792e-02   0.000 1.000000    </span></span>
<span><span class="co">#&gt; XAlcohol         -4.363e-02  9.105e-02  -0.479 0.632424    </span></span>
<span><span class="co">#&gt; XMalic            7.486e-02  7.453e-02   1.004 0.316694    </span></span>
<span><span class="co">#&gt; XAsh              3.109e-01  8.238e-02   3.774 0.000224 ***</span></span>
<span><span class="co">#&gt; XAlcalinity       2.629e-03  8.691e-02   0.030 0.975908    </span></span>
<span><span class="co">#&gt; XMagnesium       -2.540e-01  6.628e-02  -3.833 0.000180 ***</span></span>
<span><span class="co">#&gt; XPhenols          1.112e-01  1.206e-01   0.922 0.358116    </span></span>
<span><span class="co">#&gt; XFlavanoids      -4.876e-01  1.492e-01  -3.267 0.001321 ** </span></span>
<span><span class="co">#&gt; XProanthocyanins  5.665e-02  8.152e-02   0.695 0.488121    </span></span>
<span><span class="co">#&gt; XColor            4.774e-02  1.010e-01   0.473 0.636979    </span></span>
<span><span class="co">#&gt; XHue              1.945e-01  9.154e-02   2.125 0.035066 *  </span></span>
<span><span class="co">#&gt; XDilution        -2.527e-01  1.113e-01  -2.271 0.024464 *  </span></span>
<span><span class="co">#&gt; XProline         -5.248e-02  9.752e-02  -0.538 0.591230    </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 0.7728 on 165 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.4433, Adjusted R-squared:  0.4028 </span></span>
<span><span class="co">#&gt; F-statistic: 10.95 on 12 and 165 DF,  p-value: 7.236e-16</span></span></code></pre>
<p>The R-squared is equal to 44.33%, so aproximately 44% of the
variability is explained by this model. We also notice that the
coefficients associated to the variables Ash, Magnesium, Flavanoids, Hue
and Dilution are significants.</p>
<p>Let’s compare with the R-squared obtained with the variables selected
by the previous SIR model :</p>
<ul>
<li>
<p><a href="#a-first-sir-model">The first model res1</a> which
selected Flavanoids and Ash :</p>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">Y</span><span class="op">~</span><span class="va">Flavanoids</span><span class="op">+</span><span class="va">Ash</span>,data<span class="op">=</span><span class="va">wine</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">r.squared</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; [1] 0.351731</span></span></code></pre>
</li>
<li>
<p><a href="#thresholding-with-a-custom-lambda">The model with a
custom thresholding parameter res3</a> which selected Flavanoids, Ash,
Magnesium, Dilution, Phenols, Hue :</p>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">Y</span><span class="op">~</span><span class="va">Ash</span><span class="op">+</span><span class="va">Magnesium</span><span class="op">+</span><span class="va">Phenols</span><span class="op">+</span><span class="va">Flavanoids</span><span class="op">+</span><span class="va">Hue</span><span class="op">+</span><span class="va">Dilution</span>,data<span class="op">=</span><span class="va">wine</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">r.squared</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; [1] 0.4339991</span></span></code></pre>
</li>
</ul>
<p>The best compromise seems to be the SIR model that keep 6 variables.
The R-squared is almost identical (-1%) and half of the variables have
been kept.</p>
</div>
<div class="section level3">
<h3 id="concluding-remarks">Concluding remarks<a class="anchor" aria-label="anchor" href="#concluding-remarks"></a>
</h3>
<p>The package SIRthresholded helped us to find the relevant variables,
in order to create the best non-parametric regression on the response
variable Nonflavanoids. This example shown that only using
<code>SIR_threshold_opt</code> can be limiting on real data, especially
when the data is noisy with a small sample size. The method
<code>SIR_threshold_bootstrap</code> helped us to counter this issue,
and retrieve important information about the potential relevant
variables. Finally, the best model is <code>res4</code> which is a SIR
model only based on the 6 relevant variables : Flavanoids, Ash,
Magnesium, Dilution, Phenols, Hue.</p>
</div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Duan, N., &amp; Li, K.-C. (1991). Slicing Regression : A Link-Free
Regression Method. The Annals of Statistics, 19(2), 505‑530.</p>
<p>Dua, D. and Graff, C. (2019). UCI Machine Learning Repository.
Irvine, CA: University of California, School of Information and Computer
Science.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Clement Weinreich, Jerome Saracco, Hadrien Lorenzo.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
