---
title: "How to use the SIRthresholded package"
author: "Clément Weinreich"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
    %\VignetteIndexEntry{How to use the SIRthresholded package}
    %\VignetteEngine{knitr::rmarkdown}
    %\VignetteEncoding{UTF-8}
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

présentation de SIR et SIR thresholded ? (de manière succinte comme dans l'abstract ou la conf JDS?)

## Overview

This package offers an implementation of the SIR method, along with a thresholded version of SIR that allows variable selection. 

### SIR

Apply a single-index $SIR$ on $(X,Y)$ with $H$ slices.

### SIR_bootstrap 

Apply a single-index $SIR$ on $B$ bootstraped samples of $(X,Y)$ with $H$ slices.

### SIR_threshold

Apply a single-index $SIR$ on $(X,Y)$ with $H$ slices, with a parameter $\lambda$ which threshold the interest matrix $\widehat{\Sigma}_n^{-1}\widehat{\Gamma}_n$.

### SIR_threshold_opt

Apply a single-index SIR on $(X,Y)$ with H slices, with a thresholding of the interest matrix $\widehat{\Sigma}_n^{-1}\widehat{\Gamma}_n$ by an optimal parameter $\lambda_{opt}$. The $\lambda_{opt}$ is found automatically among a vector of `n_lambda` $\lambda$, starting from 0 to the maximum value of $\widehat{\Sigma}_n^{-1}\widehat{\Gamma}_n$. For each features of $X$, the number of $\lambda$ which implies a selection of this feature is stored (in a vector of size $p$). 

For $X \in R^{10}$ and 100 $\lambda$ values in the vector of lambdas, this sorted vector can look like this :

| X10 | X3 | X8 | X5 | X7 | X9 | X4 | X6 | X2 | X1  |
|-----|----|----|----|----|----|----|----|----|-----|
| 2   | 3  | 3  | 4  | 4  | 4  | 6  | 10 | 95 | 100 |

Then, thanks to `strucchange::breakpoints`, a breakpoint is found in this sorted vector. This breakpoint corresponds to the number of useless variables. In the last example, the breakpoint would be 8. From this breakpoint, the variables are more difficult to toggle to $0$ in $\hat{\beta}$. Then, the index of $\lambda_{opt}$ in the vector of lambdas is the first $\lambda$ whose associated $\hat{\beta}$ shows the same number of zeros as the breakpoint value.

### SIR_threshold_bootstrap

Apply a single-index optimally thresholded $SIR$ on `n_replications` bootstraped replications of $(X,Y)$ with $H$ slices. The optimal number of selected variables is the number of selected variables that came back most often among the replications performed. From this, we can get the corresponding $\hat{\beta}$ and $\lambda_{opt}$ that produce the same number of selected variables in the result of `SIR_threshold_opt`.

## Example with simulated data

```{r,fig.align='center'}
set.seed(1)
n <- 200
p <- 30
p_star <- 10
X <- mvtnorm::rmvnorm(n,sigma=diag(p))
dimnames(X) <- list(1:n, paste("X", 1:p, sep = ""))

eps <- rnorm(n, sd = 15)

beta <- matrix(c(rep(1,p_star),rep(0,p-p_star)),ncol=1)
rownames(beta) <- colnames(X)

Y <- (X %*% beta)**3 + eps

plot(X %*% beta, Y, xlab = "true index")
```

## Example with ?????? dataset

```{r, fig.show='hold'}
plot(1:10)
plot(10:1)
```


You can write math expressions, e.g. $Y = X\beta + \epsilon$, footnotes^[A footnote here.], and tables
